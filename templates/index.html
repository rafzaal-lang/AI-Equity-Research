<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AI Equity Research Analyst | Professional Financial Platform</title>

  <link rel="icon" type="image/x-icon" href="/static/favicon.ico" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <style>
    :root {
      --primary-blue:#0052cc; --dark-blue:#003d99; --light-blue:#e6f2ff;
      --accent-gold:#ffa500; --text-primary:#1a1a1a; --text-secondary:#666;
      --text-muted:#999; --background-primary:#fff; --background-secondary:#f8f9fa;
      --background-tertiary:#e9ecef; --border-color:#dee2e6;
      --shadow-light:rgba(0,0,0,0.08); --shadow-medium:rgba(0,0,0,0.12);
      --success-color:#28a745; --warning-color:#ffc107; --error-color:#dc3545;
    }
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family:'Inter',-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;
      background:linear-gradient(135deg,#f8f9fa 0%,#e9ecef 100%);
      color:var(--text-primary); line-height:1.5; overflow-x:hidden;
    }
    /* Header */
    .header{ background:linear-gradient(90deg,var(--primary-blue) 0%,var(--dark-blue) 100%); color:#fff; padding:1rem 2rem; box-shadow:0 2px 10px var(--shadow-medium); position:fixed; top:0; left:0; right:0; z-index:1000;}
    .header-content{ max-width:1400px; margin:0 auto; display:flex; justify-content:space-between; align-items:center;}
    .logo{ display:flex; align-items:center; gap:.75rem; font-weight:700; font-size:1.25rem;}
    .logo i{ font-size:1.5rem; color:var(--accent-gold);}
    .status-indicator{ display:flex; align-items:center; gap:.5rem; padding:.5rem 1rem; background:rgba(255,255,255,.1); border-radius:20px; font-size:.875rem;}
    .status-dot{ width:8px; height:8px; border-radius:50%; background:var(--success-color); animation:pulse 2s infinite;}
    @keyframes pulse{0%{opacity:1}50%{opacity:.5}100%{opacity:1}}

    /* Layout */
    .main-container{ margin-top:80px; min-height:calc(100vh - 80px); display:flex; }
    .sidebar{ width:300px; background:var(--background-primary); border-right:1px solid var(--border-color); box-shadow:2px 0 10px var(--shadow-light); display:flex; flex-direction:column;}
    .sidebar-header{ padding:1.5rem; border-bottom:1px solid var(--border-color);}
    .new-chat-btn{ width:100%; padding:.75rem 1rem; background:var(--primary-blue); color:#fff; border:none; border-radius:8px; font-size:.875rem; font-weight:500; cursor:pointer; transition:all .2s; display:flex; align-items:center; gap:.5rem;}
    .new-chat-btn:hover{ background:var(--dark-blue); transform:translateY(-1px);}
    .llm-selector{ margin-top:1rem;}
    .llm-selector label{ display:block; font-size:.75rem; font-weight:500; color:var(--text-secondary); margin-bottom:.5rem; text-transform:uppercase; letter-spacing:.5px;}
    .llm-select{ width:100%; padding:.5rem; border:1px solid var(--border-color); border-radius:6px; background:var(--background-primary); font-size:.875rem; color:var(--text-primary);}
    .sidebar-content{ flex:1; overflow-y:auto; padding:1rem;}
    .analytics-panel{ background:var(--background-secondary); border-radius:8px; padding:1rem; margin-bottom:1rem;}
    .analytics-title{ font-size:.875rem; font-weight:600; margin-bottom:.75rem; color:var(--text-primary);}
    .metric-item{ display:flex; justify-content:space-between; align-items:center; padding:.5rem 0; border-bottom:1px solid var(--border-color); font-size:.8rem;}
    .metric-item:last-child{ border-bottom:none;}
    .metric-value{ font-weight:500; color:var(--primary-blue);}
    .report-actions{ padding:1rem; background:var(--background-secondary); border-top:1px solid var(--border-color);}
    .generate-report-btn{ width:100%; padding:.75rem 1rem; background:var(--accent-gold); color:#fff; border:none; border-radius:8px; font-size:.875rem; font-weight:600; cursor:pointer; transition:all .2s; display:flex; align-items:center; justify-content:center; gap:.5rem;}
    .generate-report-btn:hover{ background:#ff8c00; transform:translateY(-1px);}
    .generate-report-btn:disabled{ background:var(--text-muted); cursor:not-allowed;}

    .chat-container{ flex:1; display:flex; flex-direction:column; background:var(--background-primary);}
    .chat-header{ padding:1.5rem 2rem; border-bottom:1px solid var(--border-color); background:var(--background-secondary);}
    .chat-title{ font-size:1.5rem; font-weight:700; color:var(--text-primary); margin-bottom:.25rem;}
    .chat-subtitle{ font-size:.875rem; color:var(--text-secondary);}
    .chat-messages{ flex:1; overflow-y:auto; padding:2rem; background:linear-gradient(to bottom,var(--background-primary) 0%, var(--background-secondary) 100%);}
    .message{ display:flex; gap:1rem; margin-bottom:2rem; animation:fadeIn .3s ease-out;}
    @keyframes fadeIn{ from{opacity:0; transform:translateY(10px);} to{opacity:1; transform:none;} }
    .message-avatar{ width:40px; height:40px; border-radius:50%; display:flex; align-items:center; justify-content:center; flex-shrink:0; font-size:1.1rem; font-weight:600;}
    .user-avatar{ background:var(--primary-blue); color:#fff;}
    .assistant-avatar{ background:var(--accent-gold); color:#fff;}
    .message-content{ flex:1; background:var(--background-primary); padding:1.25rem; border-radius:12px; box-shadow:0 2px 8px var(--shadow-light); border:1px solid var(--border-color); position:relative;}
    .message-content::before{ content:""; position:absolute; top:12px; left:-6px; width:12px; height:12px; background:var(--background-primary); border:1px solid var(--border-color); border-right:none; border-bottom:none; transform:rotate(-45deg);}
    .message-text{ font-size:.95rem; line-height:1.6; color:var(--text-primary);}
    .message-time{ font-size:.75rem; color:var(--text-muted); margin-top:.5rem;}

    .typing-indicator{ display:flex; align-items:center; gap:.5rem; padding:1rem; color:var(--text-secondary); font-size:.875rem; font-style:italic;}
    .typing-dots{ display:flex; gap:2px;}
    .typing-dot{ width:4px; height:4px; border-radius:50%; background:var(--primary-blue); animation:typing 1.4s infinite ease-in-out;}
    .typing-dot:nth-child(1){ animation-delay:-.32s;}
    .typing-dot:nth-child(2){ animation-delay:-.16s;}
    @keyframes typing{ 0%,80%,100%{ transform:scale(.8); opacity:.5;} 40%{ transform:scale(1); opacity:1;} }

    .chat-input-container{ padding:1.5rem 2rem; background:var(--background-primary); border-top:1px solid var(--border-color);}
    .quick-actions{ display:flex; gap:.75rem; margin-bottom:1rem; flex-wrap:wrap;}
    .quick-action-btn{ padding:.5rem 1rem; background:var(--background-secondary); border:1px solid var(--border-color); border-radius:20px; font-size:.8rem; color:var(--text-secondary); cursor:pointer; transition:all .2s;}
    .quick-action-btn:hover{ background:var(--light-blue); border-color:var(--primary-blue); color:var(--primary-blue); }

    .input-wrapper{ position:relative; max-width:800px; margin:0 auto;}
    .chat-input{ width:100%; padding:1rem 4rem 1rem 1.25rem; border:2px solid var(--border-color); border-radius:25px; font-size:.95rem; background:var(--background-secondary); color:var(--text-primary); resize:none; outline:none; transition:all .2s; min-height:50px; max-height:120px;}
    .chat-input:focus{ border-color:var(--primary-blue); background:#fff; box-shadow:0 0 0 3px rgba(0,82,204,.1);}
    .send-btn{ position:absolute; right:8px; top:50%; transform:translateY(-50%); width:36px; height:36px; border:none; background:var(--primary-blue); color:#fff; border-radius:50%; cursor:pointer; display:flex; align-items:center; justify-content:center; font-size:.875rem; transition:all .2s;}
    .send-btn:hover{ background:var(--dark-blue); transform:translateY(-50%) scale(1.05);}
    .send-btn:disabled{ background:var(--text-muted); cursor:not-allowed;}

    /* Tables & helpers */
    .data-table{ width:100%; border-collapse:collapse; margin:1rem 0; font-size:.875rem; background:#fff; border-radius:8px; overflow:hidden; box-shadow:0 2px 8px var(--shadow-light);}
    .data-table th,.data-table td{ padding:.75rem 1rem; text-align:left; border-bottom:1px solid var(--border-color);}
    .data-table th{ background:var(--background-secondary); font-weight:600; color:var(--text-primary);}
    .data-table tr:hover{ background:var(--light-blue);}
    .positive{ color:var(--success-color);} .negative{ color:var(--error-color);}

    @media (max-width:768px){
      .sidebar{ display:none; }
      .main-container{ margin-top:70px; }
      .chat-messages{ padding:1rem; }
      .chat-input-container{ padding:1rem; }
      .message{ gap:.75rem; }
      .message-avatar{ width:32px; height:32px; font-size:.9rem; }
    }

    .chat-messages::-webkit-scrollbar, .sidebar-content::-webkit-scrollbar { width:6px; }
    .chat-messages::-webkit-scrollbar-track, .sidebar-content::-webkit-scrollbar-track { background:var(--background-tertiary); }
    .chat-messages::-webkit-scrollbar-thumb, .sidebar-content::-webkit-scrollbar-thumb { background:var(--text-muted); border-radius:3px; }
    .chat-messages::-webkit-scrollbar-thumb:hover, .sidebar-content::-webkit-scrollbar-thumb:hover { background:var(--text-secondary); }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-content">
      <div class="logo">
        <i class="fas fa-chart-line"></i>
        <span>AI Equity Research</span>
      </div>
      <div class="status-indicator">
        <span class="status-dot"></span>
        <span>System Active</span>
      </div>
    </div>
  </header>

  <div class="main-container">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <button class="new-chat-btn" onclick="startNewChat()">
          <i class="fas fa-plus"></i> New Analysis
        </button>

        <div class="llm-selector">
          <label for="llm-provider">AI Model</label>
          <select id="llm-provider" class="llm-select">
            <option value="openai">GPT-4 Turbo</option>
            <option value="claude">Claude 3 Sonnet</option>
            <option value="grok">Grok Beta</option>
            <option value="gemini">Gemini Pro</option>
            <option value="perplexity">Perplexity</option>
          </select>
        </div>
      </div>

      <div class="sidebar-content">
        <div class="analytics-panel">
          <div class="analytics-title">Market Overview</div>
          <div id="market-metrics">
            <div class="metric-item"><span>Fed Funds Rate</span><span class="metric-value">Loading...</span></div>
            <div class="metric-item"><span>VIX</span><span class="metric-value">Loading...</span></div>
            <div class="metric-item"><span>10Y Yield</span><span class="metric-value">Loading...</span></div>
          </div>
        </div>

        <div class="analytics-panel">
          <div class="analytics-title">Top Performing Sectors</div>
          <div id="sector-metrics">
            <div class="metric-item"><span>Loading sectors...</span><span class="metric-value">--</span></div>
          </div>
        </div>
      </div>

      <div class="report-actions">
        <button class="generate-report-btn" onclick="generateFullReport()" id="report-btn">
          <i class="fas fa-file-alt"></i> Generate Full Report
        </button>
      </div>
    </aside>

    <!-- Chat -->
    <main class="chat-container">
      <div class="chat-header">
        <h1 class="chat-title">AI Equity Research Analyst</h1>
        <p class="chat-subtitle">Multi-analyst framework • Real-time market data & institutional insights</p>
      </div>

      <div class="chat-messages" id="chat-messages">
        <div class="message">
          <div class="message-avatar assistant-avatar"><i class="fas fa-robot"></i></div>
          <div class="message-content">
            <div class="message-text">
              Welcome to the AI Equity Research platform! I’m your professional research analyst team:
              <br><br>
              📊 <strong>Macro Economist</strong> — cycle-aware macro insights<br>
              📈 <strong>Quant Analyst</strong> — momentum/RSI/volatility & rotation<br>
              💼 <strong>Fundamental Analyst</strong> — catalysts, risks, quality
              <br><br>
              Ask about sector rotation, macro indicators, or request a comprehensive research report.
            </div>
            <div class="message-time">Just now</div>
          </div>
        </div>
      </div>

      <div class="chat-input-container">
        <div class="quick-actions">
          <button class="quick-action-btn" onclick="sendQuickMessage('What sectors are outperforming today?')">Sector Performance</button>
          <button class="quick-action-btn" onclick="sendQuickMessage('Analyze current market rotation patterns')">Rotation Analysis</button>
          <button class="quick-action-btn" onclick="sendQuickMessage('What is the macro economic outlook?')">Macro Outlook</button>
          <button class="quick-action-btn" onclick="sendQuickMessage('Recommend defensive positioning strategies')">Risk Management</button>
        </div>

        <div class="input-wrapper">
          <textarea id="chat-input" class="chat-input" placeholder="Ask about sectors, macro, or request a research report..." onkeypress="handleKeyPress(event)" rows="1"></textarea>
          <button class="send-btn" onclick="sendMessage()" id="send-btn">
            <i class="fas fa-paper-plane"></i>
          </button>
        </div>
      </div>
    </main>
  </div>

  <script src="/static/app.js" defer></script>
</body>
</html>
